# ludics configuration — exhaustive reference with all defaults
# You can either copy this file wholesale to ~/.config/ludics/config.yaml,
# or cherry-pick only the settings you want to override (unset keys use
# the defaults shown here).

# Where to store state (your private repo)
state_repo: your-username/your-private-repo
state_path: harness                   # Subdirectory within the state repo

# Number of concurrent slots (default: 6, a forcing function)
slots:
  count: 6

# Projects to track
projects:
  - name: my-project
    repo: your-username/my-project
    issues: true          # Include GitHub issues as tasks
    priority: false       # Priority project: preempt slots when tasks arrive

  - name: personal
    repo: your-username/private-repo
    issues: true          # Chores, reminders, etc.

# Adapter settings
# Available adapters: agent-claude, agent-codex, agent-duo,
#                     agent-pair-codex, agent-pair-claude, agent-pair,
#                     claude-ai, chatgpt-com, manual
# Legacy aliases: claude-code -> agent-claude, codex -> agent-codex
adapters:
  agent-claude:
    enabled: true         # Claude Code CLI agent
  agent-codex:
    enabled: false        # Codex CLI agent
  agent-duo:
    enabled: true         # Dual agent system (Claude + Codex)
  agent-pair-codex:
    enabled: false        # Pair workflow (coder=Codex, reviewer=Claude)
  agent-pair-claude:
    enabled: false        # Pair workflow (coder=Claude, reviewer=Codex)
  agent-pair:
    enabled: false        # Alias for agent-pair-codex
  claude-ai:
    enabled: true         # Claude.ai web interface
  chatgpt-com:
    enabled: false        # ChatGPT.com web interface
  manual:
    enabled: false        # Manual human work tracking
  # Legacy aliases (still recognized for existing slot files)
  claude-code:
    enabled: false        # Legacy alias for agent-claude
  codex:
    enabled: false        # Legacy alias for agent-codex

# Mag: Autonomous coordinator (Claude Opus in Claude Code)
# Provides strategic thinking while automation handles reliable execution
mag:
  enabled: false
  backend: tmux-ttyd        # tmux-ttyd (with web terminal) or tmux (no web terminal)
  session: ludics-mag         # tmux session name
  ttyd_port: 7679            # Web terminal port (tmux-ttyd backend only)
  keepalive_interval: 60      # Keepalive trigger interval in seconds (default: 60)

  # Autonomy levels: auto | suggest | manual
  autonomy_level:
    analyze_issues: auto        # Auto creates task files from issues
    elaborate_tasks: auto       # Auto writes detailed specs
    infer_dependencies: auto    # Auto adds blocks/blocked-by
    suggest_priorities: suggest # Suggests, doesn't set
    preempt_slots: suggest      # Preempt a slot for priority project tasks
    assign_to_slots: manual     # Requires approval
    start_sessions: manual      # Requires approval

  # Schedule for automated invocations
  schedule:
    briefing: "08:00"           # Morning briefing time (HH:MM)
    health_check: "every 4h"    # Periodic health check interval
    analyze_repos: "on_change"  # Triggered by WatchPaths

# Dashboard settings
dashboard:
  port: 7678                    # HTTP server port (default: 7678)
  ttl: 5                        # Data regeneration TTL in seconds (default: 5)

# Three-tier notification system via ntfy.sh
notifications:
  provider: ntfy              # Currently only ntfy.sh supported
  token: ""                   # Bearer token for ntfy.sh authentication (optional)

  # Topic names (use random suffixes for privacy without ntfy subscription)
  topics:
    pai: your-username-pai           # Private strategic (Mag)
    agents: your-username-agents     # Private operational (workers)
    public: your-username-public     # Public read-only (broadcasts)

  # Priority levels by event type (1=min, 5=urgent; default: 3)
  priorities:
    briefing: 3
    health_check: 3
    deadline_7days: 4
    deadline_3days: 5
    critical_alert: 5

  # What gets auto-published to public topic
  public_filter:
    auto_publish:
      - release_completed
      - paper_accepted
      - talk_accepted

    never_publish:
      - debugging_info
      - private_deadlines
      - internal_tasks
      - slot_states

# Triggers (macOS launchd / Linux systemd)
triggers:
  # Run at system login
  startup:
    enabled: false
    action: mag briefing

  # Periodic sync (e.g., every hour)
  sync:
    enabled: false
    interval: 3600            # seconds
    action: tasks sync

  # Morning briefing (StartCalendarInterval)
  morning:
    enabled: false
    hour: 8                   # 08:00
    minute: 0
    action: mag briefing

  # Periodic health check
  health:
    enabled: false
    interval: 14400           # 4 hours in seconds
    action: mag health-check

  # Dashboard server (long-running, KeepAlive/Restart)
  dashboard:
    enabled: false
    port: 7678                  # Override dashboard.port for this trigger

  # Watch for file changes (WatchPaths / PathModified)
  # List of rules — each rule has paths to watch and an action to run.
  # Files from "tasks sync" rules are also scanned for checkboxes/TODOs.
  watch:
    # - paths:
    #     - ~/repos/my-project/README.md
    #     - ~/repos/my-project/ROADMAP.md
    #   action: tasks sync
    # - paths:
    #     - ~/private-state/harness/tasks
    #   action: mag health-check

  # Federation heartbeat (multi-machine only)
  federation:
    enabled: false
    interval: 300             # 5 minutes in seconds
    action: federation tick

# Multi-machine setup via Tailscale
network:
  mode: localhost             # localhost (single machine) or tailscale (multi-machine)
  hostname: ""                # Optional explicit hostname override

  # Nodes listed in seniority order (highest first = leader)
  nodes: []
    # Example:
    # - name: mac-mini
    #   tailscale_hostname: mac-mini.tailnet-name.ts.net
    # - name: macbook
    #   tailscale_hostname: macbook.tailnet-name.ts.net
